r = (x + ??) & ~(x - ??);
done = 1;
i = W-1;
